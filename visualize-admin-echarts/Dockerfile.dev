# Development Dockerfile for Visualize
# Optimized for hot-reloading and development workflow

FROM node:22

WORKDIR /usr/src/app

# Install dependencies
COPY package.json yarn.lock ./
COPY app/package.json ./app/
RUN yarn install

# Environment for development
ENV NODE_ENV=development
ENV NODE_OPTIONS="--max-http-header-size=65536"
ENV NEXT_TELEMETRY_DISABLED=1
ENV PORT=3000

# Copy application code
COPY . .

# Run database migrations and start dev server
CMD ["sh", "-c", "yarn db:migrate:dev && yarn dev"]

EXPOSE 3000
